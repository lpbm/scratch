var shortcut={all_shortcuts:{},add:function(b,a,c){var d={type:"keydown",propagate:!1,disable_in_input:!1,target:document,keycode:!1};if(c)for(var f in d)typeof c[f]=="undefined"&&(c[f]=d[f]);else c=d;d=c.target;typeof c.target=="string"&&(d=document.getElementById(c.target));b=b.toLowerCase();f=function(g){g=g||window.event;if(c.disable_in_input){var e;if(g.target)e=g.target;else if(g.srcElement)e=g.srcElement;if(e.nodeType==3)e=e.parentNode;if(e.tagName=="INPUT"||e.tagName=="TEXTAREA")return}if(g.keyCode)code=
g.keyCode;else if(g.which)code=g.which;e=String.fromCharCode(code).toLowerCase();code==188&&(e=",");code==190&&(e=".");var d=b.split("+"),j=0,f={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},n={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,
end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},h=!1,l=!1,o=!1,q=!1,r=!1,s=!1,t=!1,u=!1;g.ctrlKey&&(q=!0);g.shiftKey&&(l=!0);g.altKey&&(s=!0);g.metaKey&&(u=!0);for(var p=0;k=d[p],p<d.length;p++)k=="ctrl"||k=="control"?(j++,o=!0):k=="shift"?(j++,h=!0):k=="alt"?(j++,r=!0):k=="meta"?(j++,t=!0):k.length>1?n[k]==code&&j++:c.keycode?c.keycode==code&&j++:e==k?j++:f[e]&&
g.shiftKey&&(e=f[e],e==k&&j++);if(j==d.length&&q==o&&l==h&&s==r&&u==t&&(a(g),!c.propagate))return g.cancelBubble=!0,g.returnValue=!1,g.stopPropagation&&(g.stopPropagation(),g.preventDefault()),!1};this.all_shortcuts[b]={callback:f,target:d,event:c.type};d.addEventListener?d.addEventListener(c.type,f,!1):d.attachEvent?d.attachEvent("on"+c.type,f):d["on"+c.type]=f},remove:function(b){var b=b.toLowerCase(),a=this.all_shortcuts[b];delete this.all_shortcuts[b];if(a){var b=a.event,c=a.target,a=a.callback;
c.detachEvent?c.detachEvent("on"+b,a):c.removeEventListener?c.removeEventListener(b,a,!1):c["on"+b]=!1}}};
function Sanitize(b){var a;a=b||{};this.config={};this.config.elements=a.elements?a.elements:[];this.config.attributes=a.attributes?a.attributes:{};this.config.attributes[Sanitize.ALL]=this.config.attributes[Sanitize.ALL]?this.config.attributes[Sanitize.ALL]:[];this.config.allow_comments=a.allow_comments?a.allow_comments:!1;this.allowed_elements={};this.config.protocols=a.protocols?a.protocols:{};this.config.add_attributes=a.add_attributes?a.add_attributes:{};this.dom=a.dom?a.dom:document;for(b=0;b<
this.config.elements.length;b++)this.allowed_elements[this.config.elements[b]]=!0;this.config.remove_element_contents={};this.config.remove_all_contents=!1;if(a.remove_contents)if(a.remove_contents instanceof Array)for(b=0;b<a.remove_contents.length;b++)this.config.remove_element_contents[a.remove_contents[b]]=!0;else this.config.remove_all_contents=!0;this.transformers=a.transformers?a.transformers:[]}Sanitize.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i;
Sanitize.RELATIVE="__relative__";
Sanitize.prototype.clean_node=function(b){function a(a,b){var c;for(c=0;c<b.length;c++)if(b[c]==a)return c;return-1}function c(){var a=[],b={},c,d;for(c=0;c<arguments.length;c++)if(arguments[c]&&arguments[c].length)for(d=0;d<arguments[c].length;d++)b[arguments[c][d]]||(b[arguments[c][d]]=!0,a.push(arguments[c][d]));return a}function d(b){var e;switch(b.nodeType){case 1:var f,j,m,n,h,l,o;f=[];j=b;n=!1;for(m=0;m<this.transformers.length;m++)if(h=this.transformers[m]({allowed_elements:this.allowed_elements,config:this.config,
node:b,node_name:b.nodeName.toLowerCase(),whitelist_nodes:this.whitelist_nodes,dom:this.dom}),h!=null)if(typeof h=="object"){if(h.whitelist_nodes&&h.whitelist_nodes instanceof Array)for(n=0;n<h.whitelist_nodes.length;n++)a(h.whitelist_nodes[n],this.whitelist_nodes)===-1&&this.whitelist_nodes.push(h.whitelist_nodes[n]);n=h.whitelist?!0:!1;h.attr_whitelist&&(f=c(f,h.attr_whitelist));j=h.node?h.node:j}else throw Error("transformer output must be an object or null");b=j;m=b.nodeName.toLowerCase();j=this.current_element;
if(this.allowed_elements[m]||n){this.current_element=this.dom.createElement(b.nodeName);j.appendChild(this.current_element);n=c(this.config.attributes[m],this.config.attributes.__ALL__,f);for(f=0;f<n.length;f++)if(e=n[f],h=b.attributes[e])if(l=!0,this.config.protocols[m]&&this.config.protocols[m][e]&&(l=this.config.protocols[m][e],l=(o=h.nodeValue.toLowerCase().match(Sanitize.REGEX_PROTOCOL))?a(o[1],l)!=-1:a(Sanitize.RELATIVE,l)!=-1),l)l=document.createAttribute(e),l.value=h.nodeValue,this.current_element.setAttributeNode(l);
if(this.config.add_attributes[m])for(e in this.config.add_attributes[m])l=document.createAttribute(e),l.value=this.config.add_attributes[m][e],this.current_element.setAttributeNode(l)}else if(a(b,this.whitelist_nodes)!=-1){for(this.current_element=b.cloneNode(!0);this.current_element.childNodes.length>0;)this.current_element.removeChild(this.current_element.firstChild);j.appendChild(this.current_element)}if(!this.config.remove_all_contents&&!this.config.remove_element_contents[m])for(f=0;f<b.childNodes.length;f++)d.call(this,
b.childNodes[f]);this.current_element.normalize&&this.current_element.normalize();this.current_element=j;break;case 3:e=b.cloneNode(!1);this.current_element.appendChild(e);break;case 5:e=b.cloneNode(!1);this.current_element.appendChild(e);break;case 8:this.config.allow_comments&&(e=b.cloneNode(!1),this.current_element.appendChild(e));default:console.log("unknown node type",b.nodeType)}}var f=this.dom.createDocumentFragment();this.current_element=f;this.whitelist_nodes=[];for(i=0;i<b.childNodes.length;i++)d.call(this,
b.childNodes[i]);f.normalize&&f.normalize();return f};
(function(b){var a={edit:function(a){return this.each(function(){b(this).attr("contentEditable",a===!0?!0:!1);document.execCommand("styleWithCSS",!1,null)})},bold:function(){document.execCommand("bold",!1,null)},italicize:function(){document.execCommand("italic",!1,null)},underline:function(){document.execCommand("underline",!1,null)},strikethrough:function(){document.execCommand("strikethrough",!1,null)},orderedList:function(){document.execCommand("InsertOrderedList",!1,null)},unorderedList:function(){document.execCommand("InsertUnorderedList",
!1,null)},indent:function(){document.execCommand("indent",!1,null)},outdent:function(){document.execCommand("outdent",!1,null)},superscript:function(){document.execCommand("superscript",!1,null)},subscript:function(){document.execCommand("subscript",!1,null)},createLink:function(){var a=prompt("Enter URL:","http://");document.execCommand("createLink",!1,a)},insertImage:function(){var a=prompt("Enter Image URL:","http://");document.execCommand("InsertImage",!1,a)},formatBlock:function(a){document.execCommand("FormatBlock",
null,a)},removeFormat:function(){document.execCommand("removeFormat",!1,null)},copy:function(){document.execCommand("Copy",!1,null)},paste:function(){document.execCommand("Paste",!1,null)},save:function(a){return this.each(function(){a(b(this).attr("id"),b(this).html())})},init:function(c){if(typeof c!="undefined"&&typeof c.toolbar!="undefined"){var d=b(c.toolbar);b(window).scroll(function(){var a=b(window).scrollTop(),c=d.offset().top;a>c?b("div.buttons",d).css({position:"fixed",top:"0"}):b("div.buttons",
d).css("position","relative")});b("a.toolbar_bold",d).click(function(){a.bold.apply(this);return!1});b("a.toolbar_italic",d).click(function(){a.italicize.apply(this);return!1});b("a.toolbar_underline",d).click(function(){a.underline.apply(this);return!1});b("a.toolbar_remove",d).click(function(){a.removeFormat.apply(this);return!1});b("a.toolbar_link",d).click(function(){a.createLink.apply(this);return!1});b("a.toolbar_image",d).click(function(){a.insertImage.apply(this);return!1});b("a.toolbar_blockquote",
d).click(function(){a.formatBlock.apply(this,["<BLOCKQUOTE>"]);return!1});b("a.toolbar_code",d).click(function(){a.formatBlock.apply(this,["<PRE>"]);return!1});b("a.toolbar_ol",d).click(function(){a.orderedList.apply(this);return!1});b("a.toolbar_ul",d).click(function(){a.unorderedList.apply(this);return!1});b("a.toolbar_sup",d).click(function(){a.superscript.apply(this);return!1});b("a.toolbar_sub",d).click(function(){a.subscript.apply(this);return!1});b("a.toolbar_p",d).click(function(){a.formatBlock.apply(this,
["<P>"]);return!1});b("a.toolbar_h1",d).click(function(){a.formatBlock.apply(this,["<H1>"]);return!1});b("a.toolbar_h2",d).click(function(){a.formatBlock.apply(this,["<H2>"]);return!1});b("a.toolbar_h3",d).click(function(){a.formatBlock.apply(this,["<H3>"]);return!1});b("a.toolbar_h4",d).click(function(){a.formatBlock.apply(this,["<H4>"]);return!1});b("a.toolbar_h5",d).click(function(){a.formatBlock.apply(this,["<H5>"]);return!1})}b.each([{keys:"Ctrl+l",method:function(){a.createLink.apply(this)}},
{keys:"Ctrl+g",method:function(){a.insertImage.apply(this)}},{keys:"Ctrl+Alt+U",method:function(){a.unorderedList.apply(this)}},{keys:"Ctrl+Alt+O",method:function(){a.orderedList.apply(this)}},{keys:"Ctrl+q",method:function(){a.formatBlock.apply(this,["<BLOCKQUOTE>"])}},{keys:"Ctrl+Alt+k",method:function(){a.formatBlock.apply(this,["<PRE>"])}},{keys:"Ctrl+.",method:function(){a.superscript.apply(this)}},{keys:"Ctrl+Shift+.",method:function(){a.subscript.apply(this)}},{keys:"Ctrl+Alt+0",method:function(){a.formatBlock.apply(this,
["p"])}},{keys:"Ctrl+enter",method:function(){console.debug("insert new paragraph")}},{keys:"Ctrl+b",method:function(){a.bold.apply(this)}},{keys:"Ctrl+i",method:function(){a.italicize.apply(this)}},{keys:"Ctrl+Alt+1",method:function(){a.formatBlock.apply(this,["h1"])}},{keys:"Ctrl+Alt+2",method:function(){a.formatBlock.apply(this,["h2"])}},{keys:"Ctrl+Alt+3",method:function(){a.formatBlock.apply(this,["h3"])}},{keys:"Ctrl+Alt+4",method:function(){a.formatBlock.apply(this,["h4"])}},{keys:"Ctrl+Alt+4",
method:function(){a.formatBlock.apply(this,["h4"])}},{keys:"Ctrl+m",method:function(){a.removeFormat.apply(this)}},{keys:"Ctrl+u",method:function(){a.underline.apply(this)}},{keys:"Ctrl+Alt+t",method:function(){a.strikethrough.apply(this)}},{keys:"tab",method:function(){a.indent.apply(this)}},{keys:"Shift+tab",method:function(){a.outdent.apply(this)}}],function(a,b){shortcut.add(b.keys,function(){b.method();return!1},{type:"keydown",propagate:!1})});return this.each(function(){var a=b(this),c=a.data("fresheditor"),
d=b("<div />",{text:a.attr("title")});c||b(this).data("fresheditor",{target:a,tooltip:d})})}};b.fn.fresheditor=function(c){if(a[c])return a[c].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof c==="object"||!c)return a.init.apply(this,arguments);else b.error("Method "+c+" does not exist on jQuery.contentEditable")}})(jQuery);